<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pong â€” Aaron Wojtaszek</title>
    <meta name="description" content="Play a game of Pong!" />
    <meta name="author" content="Aaron Wojtaszek" />
    <meta name="referrer" content="no-referrer" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <script>(function(){var s=localStorage.getItem('theme');document.documentElement.setAttribute('data-theme',s||'dark');})()</script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-52634255-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-52634255-2');
    </script>
    <style>
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .game-canvas {
            border: 2px solid var(--color-heading);
            border-radius: 4px;
            background-color: var(--color-heading);
            max-width: 100%;
            touch-action: none;
        }
        .game-score {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-heading);
        }
        .game-score span {
            color: var(--color-accent);
        }
        .game-instructions {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: var(--color-faint);
            text-align: center;
            line-height: 1.6;
        }
        .game-btn {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.6rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 500;
            color: #fff;
            background-color: var(--color-accent);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-family: inherit;
        }
        .game-btn:hover {
            background-color: var(--color-accent-hover);
        }

        /* Win modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal {
            background: var(--color-surface);
            border-radius: 12px;
            padding: 2rem;
            max-width: 340px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        .modal h3 {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.4rem;
            color: var(--color-heading);
            margin-bottom: 0.5rem;
        }
        .modal p {
            color: var(--color-muted);
            font-size: 0.95rem;
            margin-bottom: 1.25rem;
        }
        .modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-top: 1.25rem;
        }
        .modal-btn-primary {
            padding: 0.5rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 500;
            color: #fff;
            background-color: var(--color-accent);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            transition: background-color 0.2s ease;
        }
        .modal-btn-primary:hover {
            background-color: var(--color-accent-hover);
        }
    </style>
</head>
<body>

    <!-- Mobile Header -->
    <div class="mobile-header">
        <div class="mobile-header-name"><a href="index.html">Aaron Wojtaszek</a></div>
        <div class="mobile-header-actions">
            <button class="theme-toggle" aria-label="Toggle dark mode">
                <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
                <svg class="icon-moon" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
            </button>
            <button class="menu-toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>
    <div class="mobile-overlay"></div>

    <div class="site-wrapper">

        <!-- Sidebar -->
        <aside class="sidebar">
            <div>
                <div class="sidebar-header">
                    <div class="sidebar-header-row">
                        <div class="sidebar-name"><a href="index.html">Aaron Wojtaszek</a></div>
                        <button class="theme-toggle" aria-label="Toggle dark mode">
                            <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
                            <svg class="icon-moon" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
                        </button>
                    </div>
                </div>

                <nav class="sidebar-nav">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="minigame.html" class="active">Pong</a></li>
                        <li><a href="draw.html">Draw</a></li>
                        <li><a href="watch.html">Watch</a></li>
                    </ul>
                </nav>
            </div>

            <div class="sidebar-social">
                <a href="https://www.linkedin.com/in/aaronwojtaszek/" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://github.com/aaronwojtaszek" aria-label="GitHub"><i class="fab fa-github"></i></a>
                <a href="mailto:aaronwojtaszek@gmail.com" aria-label="Email"><i class="fas fa-envelope"></i></a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-content">

                <div class="section">
                    <h1 class="section-title">Pong</h1>

                    <div class="game-container">
                        <div class="game-score">
                            <div>You: <span id="playerScore">0</span></div>
                            <div>CPU: <span id="cpuScore">0</span></div>
                        </div>
                        <canvas id="pongCanvas" class="game-canvas" width="600" height="400"></canvas>
                        <button class="game-btn" id="startBtn">Start Game</button>
                        <div class="game-instructions">
                            First to 3 wins!<br>
                            <strong>Desktop:</strong> Mouse or arrow keys &nbsp;|&nbsp; <strong>Mobile:</strong> Touch &amp; drag
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <footer class="site-footer">
                    &copy; Aaron Wojtaszek. All rights reserved.
                </footer>

            </div>
        </main>

    </div>

    <!-- Win Modal -->
    <div class="modal-overlay" id="winModal">
        <div class="modal">
            <h3 id="modalTitle">You Win!</h3>
            <p id="modalMsg">Final score: 3 - 0</p>
            <div class="modal-actions">
                <button class="modal-btn-primary" id="modalClose">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        var menuToggle = document.querySelector('.menu-toggle');
        var sidebar = document.querySelector('.sidebar');
        var overlay = document.querySelector('.mobile-overlay');

        function openMenu() {
            sidebar.classList.add('open');
            overlay.classList.add('active');
            menuToggle.classList.add('active');
            document.documentElement.classList.add('menu-open');
        }

        function closeMenu() {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            menuToggle.classList.remove('active');
            document.documentElement.classList.remove('menu-open');
        }

        menuToggle.addEventListener('click', function() {
            if (sidebar.classList.contains('open')) {
                closeMenu();
            } else {
                openMenu();
            }
        });

        overlay.addEventListener('click', closeMenu);

        document.querySelectorAll('.sidebar-nav a').forEach(function(link) {
            link.addEventListener('click', closeMenu);
        });

        // Theme toggle
        document.querySelectorAll('.theme-toggle').forEach(function(btn) {
            btn.addEventListener('click', function() {
                var next = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', next);
                localStorage.setItem('theme', next);
            });
        });
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (!localStorage.getItem('theme')) {
                document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
            }
        });
    </script>

    <script>
        var canvas = document.getElementById('pongCanvas');
        var ctx = canvas.getContext('2d');
        var startBtn = document.getElementById('startBtn');
        var playerScoreEl = document.getElementById('playerScore');
        var cpuScoreEl = document.getElementById('cpuScore');
        var winModal = document.getElementById('winModal');
        var modalTitle = document.getElementById('modalTitle');
        var modalMsg = document.getElementById('modalMsg');
        var modalClose = document.getElementById('modalClose');

        var WIN_SCORE = 3;

        // ---- Sound Effects (Web Audio API) ----
        var audioCtx = null;
        function getAudioCtx() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioCtx;
        }
        function playTone(freq, duration, type, vol) {
            try {
                var ctx = getAudioCtx();
                var osc = ctx.createOscillator();
                var gain = ctx.createGain();
                osc.type = type || 'square';
                osc.frequency.value = freq;
                gain.gain.value = vol || 0.12;
                gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.start(ctx.currentTime);
                osc.stop(ctx.currentTime + duration);
            } catch(e) {}
        }
        function sndPaddle()  { playTone(440, 0.08, 'square', 0.12); }
        function sndWall()    { playTone(300, 0.06, 'sine', 0.08); }
        function sndScoreFor()  { playTone(660, 0.15, 'square', 0.1); }
        function sndScoreAgainst() { playTone(180, 0.25, 'sawtooth', 0.1); }
        function sndWin() {
            playTone(523, 0.12, 'square', 0.12);
            setTimeout(function(){ playTone(659, 0.12, 'square', 0.12); }, 120);
            setTimeout(function(){ playTone(784, 0.25, 'square', 0.14); }, 240);
        }
        function sndLose() {
            playTone(400, 0.15, 'sawtooth', 0.1);
            setTimeout(function(){ playTone(300, 0.15, 'sawtooth', 0.1); }, 150);
            setTimeout(function(){ playTone(200, 0.3, 'sawtooth', 0.12); }, 300);
        }

        // Responsive canvas sizing
        function resizeCanvas() {
            var container = canvas.parentElement;
            var maxW = container.clientWidth;
            if (maxW < 600) {
                canvas.width = maxW;
                canvas.height = Math.round(maxW * (2/3));
            } else {
                canvas.width = 600;
                canvas.height = 400;
            }
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        var paddleW = 10, paddleH, ballSize = 8;
        var playerY, cpuY, ballX, ballY, ballDX, ballDY;
        var playerScore = 0, cpuScore = 0;
        var gameRunning = false;
        var animFrame;
        var cpuSpeed;

        function initGame() {
            paddleH = canvas.height * 0.18;
            playerY = (canvas.height - paddleH) / 2;
            cpuY = (canvas.height - paddleH) / 2;
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
            var speed = canvas.width * 0.01;
            ballDX = speed * (Math.random() > 0.5 ? 1 : -1);
            ballDY = speed * (Math.random() > 0.5 ? 1 : -1);
            cpuSpeed = speed * 0.42;
        }

        function drawRect(x, y, w, h, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, w, h);
        }

        function drawBall(x, y, r, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawNet() {
            ctx.setLineDash([6, 6]);
            ctx.strokeStyle = '#444';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function draw() {
            drawRect(0, 0, canvas.width, canvas.height, '#1a1a1a');
            drawNet();
            drawRect(15, playerY, paddleW, paddleH, '#4a6fa5');
            drawRect(canvas.width - 15 - paddleW, cpuY, paddleW, paddleH, '#e8e8e4');
            drawBall(ballX, ballY, ballSize, '#fff');
        }

        function update() {
            ballX += ballDX;
            ballY += ballDY;

            if (ballY - ballSize < 0 || ballY + ballSize > canvas.height) {
                ballDY = -ballDY;
                sndWall();
            }

            if (ballX - ballSize < 15 + paddleW && ballY > playerY && ballY < playerY + paddleH && ballDX < 0) {
                ballDX = -ballDX * 1.05;
                var hitPos = (ballY - playerY) / paddleH - 0.5;
                ballDY = hitPos * canvas.width * 0.01;
                sndPaddle();
            }

            if (ballX + ballSize > canvas.width - 15 - paddleW && ballY > cpuY && ballY < cpuY + paddleH && ballDX > 0) {
                ballDX = -ballDX * 1.05;
                var hitPos = (ballY - cpuY) / paddleH - 0.5;
                ballDY = hitPos * canvas.width * 0.01;
                sndPaddle();
            }

            // CPU only reacts when ball is heading toward it
            var cpuCenter = cpuY + paddleH / 2;
            if (ballDX > 0) {
                var deadZone = paddleH * 0.35;
                if (cpuCenter < ballY - deadZone) {
                    cpuY += cpuSpeed;
                } else if (cpuCenter > ballY + deadZone) {
                    cpuY -= cpuSpeed;
                }
            } else {
                // Drift slowly toward center when ball is going away
                var center = canvas.height / 2;
                if (cpuCenter < center - 5) {
                    cpuY += cpuSpeed * 0.3;
                } else if (cpuCenter > center + 5) {
                    cpuY -= cpuSpeed * 0.3;
                }
            }
            cpuY = Math.max(0, Math.min(canvas.height - paddleH, cpuY));

            // Scoring
            if (ballX - ballSize < 0) {
                cpuScore++;
                cpuScoreEl.textContent = cpuScore;
                if (cpuScore >= WIN_SCORE) {
                    sndLose();
                    endGame(false);
                    return;
                }
                sndScoreAgainst();
                resetBall();
            }
            if (ballX + ballSize > canvas.width) {
                playerScore++;
                playerScoreEl.textContent = playerScore;
                if (playerScore >= WIN_SCORE) {
                    sndWin();
                    endGame(true);
                    return;
                }
                sndScoreFor();
                resetBall();
            }

            var maxSpeed = canvas.width * 0.024;
            if (Math.abs(ballDX) > maxSpeed) ballDX = maxSpeed * Math.sign(ballDX);
            if (Math.abs(ballDY) > maxSpeed) ballDY = maxSpeed * Math.sign(ballDY);
        }

        function resetBall() {
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
            var speed = canvas.width * 0.01;
            ballDX = speed * (Math.random() > 0.5 ? 1 : -1);
            ballDY = speed * (Math.random() > 0.5 ? 1 : -1);
        }

        function endGame(playerWon) {
            gameRunning = false;
            cancelAnimationFrame(animFrame);
            startBtn.textContent = 'Play Again';
            modalTitle.textContent = playerWon ? 'You Win!' : 'CPU Wins';
            modalMsg.textContent = 'Final score: ' + playerScore + ' - ' + cpuScore;
            winModal.classList.add('active');
        }

        function gameLoop() {
            if (!gameRunning) return;
            update();
            draw();
            animFrame = requestAnimationFrame(gameLoop);
        }

        // Mouse control
        canvas.addEventListener('mousemove', function(e) {
            var rect = canvas.getBoundingClientRect();
            var scaleY = canvas.height / rect.height;
            playerY = (e.clientY - rect.top) * scaleY - paddleH / 2;
            playerY = Math.max(0, Math.min(canvas.height - paddleH, playerY));
        });

        // Touch control
        canvas.addEventListener('touchmove', function(e) {
            e.preventDefault();
            var rect = canvas.getBoundingClientRect();
            var scaleY = canvas.height / rect.height;
            var touch = e.touches[0];
            playerY = (touch.clientY - rect.top) * scaleY - paddleH / 2;
            playerY = Math.max(0, Math.min(canvas.height - paddleH, playerY));
        }, { passive: false });

        // Keyboard control
        var keysDown = {};
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
                keysDown[e.key] = true;
            }
        });
        document.addEventListener('keyup', function(e) {
            keysDown[e.key] = false;
        });

        setInterval(function() {
            if (!gameRunning) return;
            var speed = canvas.height * 0.015;
            if (keysDown['ArrowUp']) {
                playerY = Math.max(0, playerY - speed);
            }
            if (keysDown['ArrowDown']) {
                playerY = Math.min(canvas.height - paddleH, playerY + speed);
            }
        }, 16);

        // Start / Reset
        startBtn.addEventListener('click', function() {
            playerScore = 0;
            cpuScore = 0;
            playerScoreEl.textContent = '0';
            cpuScoreEl.textContent = '0';
            resizeCanvas();
            initGame();
            gameRunning = true;
            startBtn.textContent = 'Reset';
            gameLoop();
        });

        // Modal close handler
        modalClose.addEventListener('click', function() {
            winModal.classList.remove('active');
        });

        // Init
        initGame();
        draw();
    </script>

</body>
</html>
